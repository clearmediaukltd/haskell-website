<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Control.Reaper</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Control-Reaper.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">auto-update-0.1.2.1: Efficiently run periodic, on-demand actions</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Control.Reaper</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Settings</a></li><li><a href="#g:2">Accessors</a></li><li><a href="#g:3">Type</a></li><li><a href="#g:4">Creation</a></li><li><a href="#g:5">Helper</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>This module provides the ability to create reapers: dedicated cleanup
 threads. These threads will automatically spawn and die based on the
 presence of a workload to process on.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:ReaperSettings">ReaperSettings</a> workload item</li><li class="src short"><a href="#v:defaultReaperSettings">defaultReaperSettings</a> ::  <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> [item] item</li><li class="src short"><a href="#v:reaperAction">reaperAction</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; workload -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> (workload -&gt; workload)</li><li class="src short"><a href="#v:reaperDelay">reaperDelay</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Int.html#t:Int">Int</a></li><li class="src short"><a href="#v:reaperCons">reaperCons</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; item -&gt; workload -&gt; workload</li><li class="src short"><a href="#v:reaperNull">reaperNull</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; workload -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></li><li class="src short"><a href="#v:reaperEmpty">reaperEmpty</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; workload</li><li class="src short"><span class="keyword">data</span> <a href="#t:Reaper">Reaper</a> workload item = <a href="#v:Reaper">Reaper</a> {<ul class="subs"><li><a href="#v:reaperAdd">reaperAdd</a> :: item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> ()</li><li><a href="#v:reaperRead">reaperRead</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> workload</li><li><a href="#v:reaperStop">reaperStop</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> workload</li></ul>}</li><li class="src short"><a href="#v:mkReaper">mkReaper</a> ::  <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> (<a href="Control-Reaper.html#t:Reaper">Reaper</a> workload item)</li><li class="src short"><a href="#v:mkListAction">mkListAction</a> ::  (item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Maybe.html#t:Maybe">Maybe</a> item')) -&gt; [item] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> ([item'] -&gt; [item'])</li></ul></div><div id="interface"><h1 id="g:1">Settings</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:ReaperSettings" class="def">ReaperSettings</a> workload item</p><div class="doc"><p>Settings for creating a reaper. This type has two parameters:
 <code>workload</code> gives the entire workload, whereas <code>item</code> gives an
 individual piece of the queue. A common approach is to have <code>workload</code>
 be a list of <code>item</code>s. This is encouraged by <code><a href="Control-Reaper.html#v:defaultReaperSettings">defaultReaperSettings</a></code> and
 <code><a href="Control-Reaper.html#v:mkListAction">mkListAction</a></code>.</p><p>Since 0.1.1</p></div></div><div class="top"><p class="src"><a name="v:defaultReaperSettings" class="def">defaultReaperSettings</a> ::  <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> [item] item</p><div class="doc"><p>Default <code>ReaperSettings</code> value, biased towards having a list of work
 items.</p><p>Since 0.1.1</p></div></div><h1 id="g:2">Accessors</h1><div class="top"><p class="src"><a name="v:reaperAction" class="def">reaperAction</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; workload -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> (workload -&gt; workload)</p><div class="doc"><p>The action to perform on a workload. The result of this is a
 &quot;workload modifying&quot; function. In the common case of using lists,
 the result should be a difference list that prepends the remaining
 workload to the temporary workload. For help with setting up such
 an action, see <code><a href="Control-Reaper.html#v:mkListAction">mkListAction</a></code>.</p><p>Default: do nothing with the workload, and then prepend it to the
 temporary workload. This is incredibly useless; you should
 definitely override this default.</p><p>Since 0.1.1</p></div></div><div class="top"><p class="src"><a name="v:reaperDelay" class="def">reaperDelay</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Int.html#t:Int">Int</a></p><div class="doc"><p>Number of microseconds to delay between calls of <code><a href="Control-Reaper.html#v:reaperAction">reaperAction</a></code>.</p><p>Default: 30 seconds.</p><p>Since 0.1.1</p></div></div><div class="top"><p class="src"><a name="v:reaperCons" class="def">reaperCons</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; item -&gt; workload -&gt; workload</p><div class="doc"><p>Add an item onto a workload.</p><p>Default: list consing.</p><p>Since 0.1.1</p></div></div><div class="top"><p class="src"><a name="v:reaperNull" class="def">reaperNull</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; workload -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Bool.html#t:Bool">Bool</a></p><div class="doc"><p>Check if a workload is empty, in which case the worker thread
 will shut down.</p><p>Default: <code><a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-List.html#v:null">null</a></code>.</p><p>Since 0.1.1</p></div></div><div class="top"><p class="src"><a name="v:reaperEmpty" class="def">reaperEmpty</a> :: <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; workload</p><div class="doc"><p>An empty workload.</p><p>Default: empty list.</p><p>Since 0.1.1</p></div></div><h1 id="g:3">Type</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Reaper" class="def">Reaper</a> workload item</p><div class="doc"><p>A data structure to hold reaper APIs.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Reaper" class="def">Reaper</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:reaperAdd" class="def">reaperAdd</a> :: item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> ()</dt><dd class="doc"><p>Adding an item to the workload</p></dd><dt class="src"><a name="v:reaperRead" class="def">reaperRead</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> workload</dt><dd class="doc"><p>Reading workload.</p></dd><dt class="src"><a name="v:reaperStop" class="def">reaperStop</a> :: <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> workload</dt><dd class="doc"><p>Stopping the reaper thread if exists.
   The current workload is returned.</p></dd></dl><div class="clear"></div></div></td></tr></table></div></div><h1 id="g:4">Creation</h1><div class="top"><p class="src"><a name="v:mkReaper" class="def">mkReaper</a> ::  <a href="Control-Reaper.html#t:ReaperSettings">ReaperSettings</a> workload item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> (<a href="Control-Reaper.html#t:Reaper">Reaper</a> workload item)</p><div class="doc"><p>Create a reaper addition function. This funciton can be used to add
 new items to the workload. Spawning of reaper threads will be handled
 for you automatically.</p><p>Since 0.1.1</p></div></div><h1 id="g:5">Helper</h1><div class="top"><p class="src"><a name="v:mkListAction" class="def">mkListAction</a> ::  (item -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> (<a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/Data-Maybe.html#t:Maybe">Maybe</a> item')) -&gt; [item] -&gt; <a href="file:///Library/Frameworks/GHC.framework/Versions/7.8.3-x86_64/usr/share/doc/ghc/html/libraries/base-4.7.0.1/System-IO.html#t:IO">IO</a> ([item'] -&gt; [item'])</p><div class="doc"><p>A helper function for creating <code><a href="Control-Reaper.html#v:reaperAction">reaperAction</a></code> functions. You would
 provide this function with a function to process a single work item and
 return either a new work item, or <code>Nothing</code> if the work item is
 expired.</p><p>Since 0.1.1</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.14.3</p></div></body></html>